<div class="auth-page">
  <div class="auth-container">

    @if(_Refresh) {
    <div class="loading-state">
      <div class="brand-logo">
        <mat-icon class="logo-icon">article</mat-icon>
        <h1 class="brand-name">BlogSpace</h1>
      </div>
      <mat-spinner class="loading-spinner"></mat-spinner>
      <p class="loading-text">Signing you in...</p>
    </div>
    } @else {

    <!-- Auth Card -->
    <div class="auth-card">

      <!-- Header -->
      <div class="auth-header">
        <h2 class="auth-title">Welcome Back</h2>
        <p class="auth-subtitle">Sign in to your account to continue</p>
      </div>

      <!-- Login Form -->
      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="auth-form">

        <!-- Email Field -->
        <div class="form-group">
          <mat-form-field appearance="outline" class="auth-field">
            <input matInput type="email" formControlName="email" placeholder="Enter your email or username" />
            <mat-icon matSuffix class="field-icon">email</mat-icon>

            @if(loginForm.get('email')?.hasError('required')) {
            <mat-error>
              <mat-icon>error</mat-icon>
              Email is required
            </mat-error>
            }
            @if(loginForm.get('email')?.hasError('email')) {
            <mat-error>
              <mat-icon>error</mat-icon>
              Please enter a valid email
            </mat-error>
            }
          </mat-form-field>
        </div>

        <!-- Password Field -->
        <div class="form-group">
          <mat-form-field appearance="outline" class="auth-field">
            <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password"
              placeholder="Enter your password" />

            <button mat-icon-button matSuffix type="button" (click)="hidePassword = !hidePassword"
              class="password-toggle">
              <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>

            @if(loginForm.get('password')?.hasError('required')) {
            <mat-error>
              <mat-icon>error</mat-icon>
              Password is required
            </mat-error>
            }
            @if(loginForm.get('password')?.hasError('minlength')) {
            <mat-error>
              <mat-icon>error</mat-icon>
              Minimum 6 characters required
            </mat-error>
            }
          </mat-form-field>
        </div>

        <!-- Submit Button -->
        <button mat-raised-button type="submit" class="auth-submit-btn" [disabled]="loginForm.invalid">
          <span>Sign In</span>
        </button>

        <!-- Error Message -->
        @if (errorMessage) {
        <div class="error-message">
          <mat-icon>error</mat-icon>
          <span>{{ errorMessage }}</span>
        </div>
        }

      </form>

      <!-- Auth Footer -->
      <div class="auth-footer">
        <div class="divider">
          <span>or</span>
        </div>

        <!-- Register Link -->
        <p class="auth-switch">
          Don't have an account?
          <a (click)="goRegister()" class="switch-link">Create one here</a>
        </p>
      </div>

    </div>

    }
  </div>
</div>
