<div class="blog-layout">
  @if(_Refresh){
  <mat-spinner></mat-spinner>
  }@else{
  <!-- Main Blog Content -->
  <div class="blog-container">
    <section class="author-section">
      <h1>{{ blog.authorName }}</h1>
      <h2>Posted on {{ formatDate(blog.createdAt) }}</h2>
    </section>

    <section class="content-section">
      <h1 class="blog-title">{{ blog.title }}</h1>

      <section class="media-section">
        @if (blog.isVideo){
        <ng-container video>
          <video [src]="blog.media" controls playsinline></video>
        </ng-container>
        }@else {
        <ng-container image>
          <img [src]="blog.media" alt="blog cover" class="media-image" />
        </ng-container>
        }
      </section>

      <div class="blog-body" [innerHTML]="toHtml(blog.content)"></div>
    </section>
  </div>

  <!-- Sidebar / Comments Section -->
  <aside class="blog-sidebar">

    <!-- Follow + Likes -->
    <div class="interaction-header">
      <div class="likes">
        <mat-icon>favorite</mat-icon> {{ blog.likes }} likes
      </div>
      <button mat-raised-button color="accent" (click)="toggleLike()">
        {{ blog.isLiking ? 'UnLike' : 'Like' }}
      </button>
    </div>

    <!-- Sticky Comments Section -->
    <div class="comments-section fixed-comments">
      <h3>Comments</h3>

      <div class="comment-form">
        <mat-form-field appearance="outline" class="comment-input">
          <mat-label>Your comment</mat-label>
          <input matInput (keydown)="setComment($event)" name="comment" required />
        </mat-form-field>
      </div>

      @for (comment of comments; track comment.id) {
      <div class="comment">
        <strong>{{ comment.author }}</strong>
        <p>{{ comment.content }}</p>
      </div>
      }

    </div>
  </aside>
  }
</div>
